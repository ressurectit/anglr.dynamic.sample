"use strict";(self.webpackChunkng_universal_demo=self.webpackChunkng_universal_demo||[]).push([[4680],{44680:(t,n,e)=>{e.r(n),e.d(n,{StateRelationsEditorMetadata:()=>P});var a=e(12405),o=e(73512),i=e(60953),s=e(12125),r=e(32123),d=e(74957),u=e(69445),c=e(25434),l=e(13816),p=e(71498),m=e(89033),f=e(38256),g=e(57165),v=e(50478),h=e(27805),y=e(63289),b=e(52455),x=e(28588),w=e(5419),F=e(4149),C=e(37654),O=e(66382),k=e(47948),_=e(13341),M=e(52900),S=e(94128),T=e(83210),I=e(81473),q=e(15704);function D(t,n,e,a,o,i,s){try{var r=t[i](s),d=r.value}catch(t){return void e(t)}r.done?n(d):Promise.resolve(d).then(a,o)}function N(t){return function(){var n=this,e=arguments;return new Promise((function(a,o){var i=t.apply(n,e);function s(t){D(i,a,o,s,r,"next",t)}function r(t){D(i,a,o,s,r,"throw",t)}s(void 0)}))}}function Z(t,n){if(1&t){const t=f.E();g.Tg(0,"div",4),g._U(1,"relation-node-input",13),g.Tg(2,"div",7)(3,"div"),v._(4),g.qZ(),g.Tg(5,"button",14),h.N("click",(function(n){const e=y.CH(t).$implicit,a=b.o();return n.preventDefault(),n.stopPropagation(),y.Kt(a.rename(e))})),g._U(6,"span",15),g.qZ(),g.Tg(7,"button",14),h.N("click",(function(n){const e=y.CH(t).$implicit,a=b.o();return n.preventDefault(),n.stopPropagation(),y.Kt(a.showCodeEditor(e))})),g._U(8,"span",16),g.qZ(),g.Tg(9,"button",17),h.N("click",(function(n){const e=y.CH(t).$implicit,a=b.o();return n.preventDefault(),n.stopPropagation(),y.Kt(a.removeInputFunc(e))})),g._U(10,"span",18),g.qZ()()()}if(2&t){const t=n.$implicit,e=b.o();x.x(1),w.Q("parentCoordiantes",e.nodePosition)("zoomLevel",e.zoomLevel)("name",t)("parent",e),x.x(3),F.Oq(t)}}p.Mj.typescript.typescriptDefaults.addExtraLib("/**\n * Function that is used for handling input value\n * @param data - Data that are passed to this function for processing\n */\nexport type InputFunction<TData = unknown, TState = unknown> = (this: StatefullClass<TState>, data: TData) => void;\n/**\n * Definition of statefull class\n */\nexport interface StatefullClass<TState = unknown> {\n    /**\n     * Current state that is stored for this class\n     */\n    state: TState | undefined | null;\n}\n//# sourceMappingURL=state.interface.d.ts.map","file:///node_modules/@types/state/index.d.ts");class E extends s.M{get inputFunctions(){var t;return this.metadata?((t=this.metadata).relationsOptions??(t.relationsOptions={inputFunctions:{}}),Object.keys(this.metadata.relationsOptions.inputFunctions??{})):[]}constructor(t,n,e){super(t,n),this.dialog=e}addInputFunc(){var t=this;return N((function*(){var n,e;const a={id:(0,l.Ox)(12),code:null},o={name:`inputFunc${t.inputFunctions.length+1}`,defaultValue:null,noDefaultValue:!0,skipInit:!1};if(yield t.configureEndpoint(o)){if(!t.metadata?.relationsOptions||!t.metadata.nodeMetadata)return;(n=t.metadata.relationsOptions).inputFunctions??(n.inputFunctions={}),t.metadata.relationsOptions.inputFunctions[o.name]=a,(e=t.metadata.nodeMetadata).options??(e.options={contents:{}}),t.metadata.nodeMetadata.options.contents&&(t.metadata.nodeMetadata.options.contents[o.name]=""),t.history.getNewState()}}))()}removeInputFunc(t){this.metadata?.relationsOptions?.inputFunctions&&t in this.metadata.relationsOptions.inputFunctions&&(delete this.metadata.relationsOptions.inputFunctions[t],this.metadata.nodeMetadata?.options?.contents&&delete this.metadata.nodeMetadata.options.contents[t],this.history.getNewState())}rename(t){var n=this;return N((function*(){yield n.configureEndpoint({name:t,defaultValue:null,noDefaultValue:!0,skipInit:!1}),n.changeDetector.detectChanges()}))()}configureEndpoint(t){var n=this;return N((function*(){const e=JSON.parse(JSON.stringify(t)),a=yield(0,m.n)(n.dialog.open(c.b,{title:"configure input function",width:"60vw",data:e}).afterClosed());return a&&(n.metadata?.relationsOptions?.inputFunctions?.[t.name]&&(""===n.metadata.nodeMetadata?.options?.contents?.[t.name]||n.metadata.nodeMetadata?.options?.contents?.[t.name])?(n.metadata.relationsOptions.inputFunctions[e.name]=n.metadata.relationsOptions.inputFunctions[t.name],delete n.metadata.relationsOptions.inputFunctions[t.name],n.metadata.nodeMetadata.options.contents[e.name]=n.metadata.nodeMetadata.options.contents[t.name],delete n.metadata.nodeMetadata.options.contents[t.name],n.history.getNewState()):t.name=e.name),a??!1}))()}showCodeEditor(t){var n=this;return N((function*(){var e,a,s;const r=yield(0,m.n)(n.dialog.open(o.I,{title:"Code editor",width:"75vw",height:"75vh",data:{content:n.metadata?.nodeMetadata?.options?.contents?.[t]??"",languageModel:(0,i.A)("import {InputFunction} from 'state';\n\n/**\n * Input function that handles incoming data and can change state\n */\nconst inputFunc: InputFunction<any, any> = function(_data)\n{\n};\n\nexport default inputFunc;\n\n")}}).afterClosed());n.metadata?.relationsOptions&&r&&n.metadata.nodeMetadata&&((e=n.metadata.relationsOptions).inputFunctions??(e.inputFunctions={}),(a=n.metadata.nodeMetadata).options??(a.options={contents:{}}),(s=n.metadata.nodeMetadata.options).contents??(s.contents={}),n.metadata.relationsOptions.inputFunctions[t].code=r.code,n.metadata.nodeMetadata.options.contents[t]=r.content,n.history.getNewState())}))()}}E.ɵfac=function(t){return new(t||E)(C.Y(O.s),C.Y(k.SB),C.Y(I.J))},E.ɵcmp=_.Xp({type:E,selectors:[["state-node"]],standalone:!0,features:[M.q,S.j],decls:17,vars:9,consts:[["name","state",3,"parent","destroySubject"],[1,"node-content"],[1,"inputs-outputs"],[1,"inputs"],[1,"input"],["name","initState",3,"parentCoordiantes","zoomLevel","parent"],["class","input",4,"ngFor","ngForOf"],[1,"dynamic-flex-row"],["type","button",1,"dynamic-btn-icon","dynamic-margin-left-extra-small",3,"click"],[1,"fas","fa-plus"],[1,"outputs"],[1,"output"],["name","state",3,"parentCoordiantes","zoomLevel","parent"],[3,"parentCoordiantes","zoomLevel","name","parent"],["type","button",1,"dynamic-btn-icon","dynamic-margin-horizontal-extra-small",3,"click"],[1,"fas","fa-pen"],[1,"fas","fa-code"],["type","button",1,"dynamic-btn-icon",3,"click"],[1,"fas","fa-times"]],template:function(t,n){1&t&&(g._U(0,"relations-node-header",0),g.Tg(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),g._U(5,"relation-node-input",5),g.Tg(6,"div"),v._(7,"init state"),g.qZ()(),T.Y(8,Z,11,5,"div",6),g.Tg(9,"div",7)(10,"button",8),h.N("click",(function(t){return t.preventDefault(),t.stopPropagation(),n.addInputFunc()})),g._U(11,"span",9),g.qZ()()(),g.Tg(12,"div",10)(13,"div",11)(14,"div"),v._(15,"state"),g.qZ(),g._U(16,"relation-node-output",12),g.qZ()()()()),2&t&&(w.Q("parent",n)("destroySubject",n.destroySubject),x.x(5),w.Q("parentCoordiantes",n.nodePosition)("zoomLevel",n.zoomLevel)("parent",n),x.x(3),w.Q("ngForOf",n.inputFunctions),x.x(8),w.Q("parentCoordiantes",n.nodePosition)("zoomLevel",n.zoomLevel)("parent",n))},dependencies:[r.e,d.P,u.n,a.e,q.sg],encapsulation:2,changeDetection:0});class P{constructor(){this.metaInfo={name:"State",description:"Node that allows storing and manipulation with statefull object",group:"Data"},this.nodeDefinition=E,Object.freeze(this)}}},25434:(t,n,e)=>{e.d(n,{b:()=>j});var a=e(12405),o=e(41762),i=e(6631),s=e(65540),r=e(74062),d=e(73512),u=e(14958),c=e(19598),l=e(13816),p=e(55163),m=e(89033);class f{constructor(t){this.defaultValue=null,this.name="",this.skipInit=!1,l.Rl.bind(this)(t)}}var g=e(57165),v=e(50478),h=e(38256),y=e(27805),b=e(63289),x=e(52455),w=e(37654),F=e(13341),C=e(18968),O=e(94128),k=e(83210),_=e(5419),M=e(28588),S=e(81473),T=e(86039),I=e(33250),q=e(58433),D=e(49308),N=e(48215),Z=e(78525),E=e(97503);function P(t,n,e,a,o,i,s){try{var r=t[i](s),d=r.value}catch(t){return void e(t)}r.done?n(d):Promise.resolve(d).then(a,o)}function L(t,n){1&t&&(g.Tg(0,"div",1)(1,"label",2),g._U(2,"input",9),v._(3," skip init "),g.qZ()())}function U(t,n){if(1&t){const t=h.E();g.Tg(0,"div",10)(1,"button",11),y.N("click",(function(){b.CH(t);const n=x.o();return b.Kt(n.showCodeEditor())})),g.Tg(2,"span"),v._(3,"default value"),g.qZ()()()}}class j{constructor(t,n,e){this.data=t,this.dialog=n,this.form=e.build(new f(t)),this.form.valueChanges.subscribe((n=>(0,l.l7)(t,n)))}showCodeEditor(){var t,n=this;return(t=function*(){const t=(0,p.EN)(n.data.defaultValue)?JSON.stringify(n.data.defaultValue,null,4):"",e=yield(0,m.n)(n.dialog.open(d.I,{title:"Code editor",width:"75vw",height:"75vh",data:{content:t,languageModel:u.H}}).afterClosed());(0,p.EN)(e)&&(n.data.defaultValue=(0,c.LK)(e.content))},function(){var n=this,e=arguments;return new Promise((function(a,o){var i=t.apply(n,e);function s(t){P(i,a,o,s,r,"next",t)}function r(t){P(i,a,o,s,r,"throw",t)}s(void 0)}))})()}}j.ɵfac=function(t){return new(t||j)(w.Y(s.m),w.Y(S.J),w.Y(r.p))},j.ɵcmp=F.Xp({type:j,selectors:[["configure-node-endpoint"]],standalone:!0,features:[C._([r.p]),O.j],decls:14,vars:5,consts:[[3,"formGroup"],[1,"dynamic-form-group","dynamic-margin-bottom-extra-small"],[1,"dynamic-control-label","dynamic-text-uppercase"],["type","text","formControlName","name",1,"dynamic-form-control"],["class","dynamic-form-group dynamic-margin-bottom-extra-small",4,"ngIf"],["class","dynamic-flex-column dynamic-margin-bottom-extra-small",4,"ngIf"],[1,"dynamic-flex-row","dynamic-flex-end"],["type","button",1,"dynamic-btn","dynamic-btn-info","dynamic-margin-right-extra-small",3,"mat-dialog-close"],["type","button",1,"dynamic-btn","dynamic-btn-primary",3,"mat-dialog-close"],["type","checkbox","formControlName","skipInit"],[1,"dynamic-flex-column","dynamic-margin-bottom-extra-small"],["type","button",1,"dynamic-btn","dynamic-btn-primary","dynamic-align-self-center",3,"click"]],template:function(t,n){1&t&&(g.Tg(0,"div",0)(1,"div",1)(2,"label",2),v._(3,"name"),g.qZ(),g._U(4,"input",3),g.qZ(),k.Y(5,L,4,0,"div",4),k.Y(6,U,4,0,"div",5),g.qZ(),g.Tg(7,"div",6)(8,"button",7)(9,"span"),v._(10,"cancel"),g.qZ()(),g.Tg(11,"button",8)(12,"span"),v._(13,"ok"),g.qZ()()()),2&t&&(_.Q("formGroup",n.form),M.x(5),_.Q("ngIf",n.data.allowSkipInit),M.x(1),_.Q("ngIf",!n.data.noDefaultValue),M.x(2),_.Q("mat-dialog-close",null),M.x(3),_.Q("mat-dialog-close",!0))},dependencies:[o.U,T.Fj,I.W,q.JJ,q.JL,D.s,N.u,i.I,Z.ZT,a.e,E.O],encapsulation:2,changeDetection:0})},60953:(t,n,e)=>{e.d(n,{A:()=>s});var a=e(71498),o=e(22957);function i(t,n,e,a,o,i,s){try{var r=t[i](s),d=r.value}catch(t){return void e(t)}r.done?n(d):Promise.resolve(d).then(a,o)}const s=t=>new o.y("typescript","ts",function(){var t,n=(t=function*(t){const n=t.getModel()?.uri;if(!n)return"";const e=yield a.Mj.typescript.getTypeScriptWorker(),o=yield e(n);return(yield o.getEmitOutput(n.toString())).outputFiles[0].text},function(){var n=this,e=arguments;return new Promise((function(a,o){var s=t.apply(n,e);function r(t){i(s,a,o,r,d,"next",t)}function d(t){i(s,a,o,r,d,"throw",t)}r(void 0)}))});return function(t){return n.apply(this,arguments)}}(),t)}}]);
//# sourceMappingURL=4680.client.chunk.c1934406547f57c69902.js.map